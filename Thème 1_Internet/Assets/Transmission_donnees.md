
### La transmission des données dans un réseau : ce qu'il faut retenir

* Dans un réseau informatique, la transmission des données se fait par **paquets** ou **trames** ce qui assure une utilisation efficace des liens de connexion.

* Une commande importante dans un réseau informatique est la **commande `ping`** qui permet de tester si la connexion peut être établie avec une machine distante à travers un réseau IP ; dans le Terminal (Windows R puis cmd) essayer par exemple `ping www.google.fr`. La commande fonctionne en envoyant un paquet à une adresse donnée et attend une réponse par exemple :  `64 bytes from 216.58.213.131: icmp_seq=3 ttl=54 time=10.366 ms `. Elle mesure ainsi la durée d'un aller-retour et rapporte les erreurs. `216.58.213.131` représente l'adresse IP locale du serveur que l'on veut atteindre.

* Une autre commande importante dans un réseau informatique est la **commande `traceroute`** (trace the route) ou **tracert** sous Windows ; dans le Terminal essayer `traceroute www.google.fr` pour afficher le chemin suivi par des paquets à travers le protocole IP. `traceroute to www.google.fr (216.58.213.131), 64 hops max, 52 byte packets` permet de suivre ansi un paquet depuis votre ordinateur jusqu'au serveur en indiquant le nombre d'étapes (hops) et le temps mis par chaque étape. Si jamais un `hop` renvoie `Request timed out` cela signifie qu'il y a une congestion du réseau ou un ralentissement du temps de chargement des pages Web. Ainsi si vous soupçonnez que des paquets se perdent entre votre ordinateur et leur destination, la commande `traceroute` permet de trouver la source du problème efficacement. 

* Un **routeur** est un équipement réseau informatique assurant le routage des paquets. Son rôle est de faire transiter des paquets d'une interface réseau vers une autre, au mieux, selon un ensemble de règles, **dans le but d'interconnecter des réseaux**.

* Dans le but d'interconnecter des ordinateurs entre eux, on utilisera un **interconnecteur** qui est un câble Ethernet.

* Le **commutateur ou switch** établit et met à jour une table; dans le cas du commutateur pour un réseau Ethernet il s'agit de la table d'adresses MAC, qui lui indique sur quels ports diriger les trames destinées à une adresse MAC donnée, en fonction des adresses MAC source des trames reçues sur chaque port. Le commutateur construit donc dynamiquement une table qui associe numéro de port et adresses MAC. 

* Un **serveur** web est un ordinateur qui héberge les pages web et qui les envoie dans la machine de l'utilisateur qui consulte ces pages. Dans **l'architecture client-serveur**, le client émet une requête vers le serveur grâce à son adresse IP et le port, qui désigne un service particulier du serveur. Le serveur reçoit la demande et répond à l'aide de l'adresse de la machine client et son port. Les services sont exploités par des programmes, appelés programmes clients, s'exécutant sur les machines clientes. On parle ainsi de client (client FTP, client de messagerie, etc.) lorsque l'on désigne un programme tournant sur une machine cliente, capable de traiter des informations qu'il récupère auprès d'un serveur (dans le cas du client FTP il s'agit de fichiers, tandis que pour le client de messagerie il s'agit de courrier électronique). On peut dire que l'architecture client-serveur est une architecture matérielle de coopération entre machines.

* Une **adresse IP** permet d'identifier un périphérique connecté au réseau. Chaque appareil connecté au réseau dispose d'une adresse IP. L'ordinateur ou le smartphone que vous utilisez dispose d'une adresse IP unique. La version 4 est actuellement la plus utilisée : elle est généralement représentée en notation décimale avec quatre nombres compris **entre 0 et 255**, séparés par des points, ce qui donne par exemple « 172.16.254.1 ». Une adresse telle que « 127.3.87.256 » serait évidemment invalide à cause de la valeur 256. La commande **`ipconfig`** (windows) ou **ifconfig** (mac) permet d'afficher l'adresse Ipv4 d'une machine. Il est alors possible de **tester le dialogue entre deux machines** en faisant un ping vers l'adresse Ipv4 d'une autre machine. Une adresse IP est constituée de deux parties permettant d'identifer le réseau et l'hôte. On utilise pour cela un masque. Si on donne une adresse 192.168.1.24 et le masque 255.255.255.0, le réseau est alors identifié par 192.168.1.0 et l'hôte par 0.0.0.24. Il existe plusieurs classes de réseaux d'adresses IPv4. 

Les adresses des réseaux de classe A ont un premier nombre compris entre 1 et 126 ; le premier bit du premier octet est un zéro. Un réseau x peut donc contenir toutes les adresses de x.0.0.0 à x.255.255.255, soit 256<sup>3</sup>=16 777 216 adresses . On dit que le masque réseau est 255.0.0.0.

Les adresses des réseaux de classe B ont un premier nombre compris entre 128 et 191 ; les deux premiers bits du premier octet sont 10 et le masque de réseau est 255.255.0.0. Un réseau x,y peut donc contenir toutes les adresses de x.y.0.0 à x.y.255.255, soit 256<sup>2</sup>=65536 adresses.

Les adresses des réseaux de classe C ont un premier nombre compris entre 192 et 223 ; les trois premiers bits du premier octet sont 110 et le masque de réseau est 255.255.255.0. Un réseau x,y,z peut donc contenir toutes les adresses de x.y.z.0 à x.y.z.255, soit 256 adresses. 

Les adresses avec un premier nombre compris entre 224 et 255, c'est-à-dire celles dont les trois premiers bits du premier octet sont 111, sont réservées à un autre usage : le multicast par exemple, qui n'utilise pas le protocole TCP, et qui consiste à diffuser vers une groupe de récepteurs.

Un particulier qui possède une connexion à Internet par l'intermédaire d'une box est sur un réseau de classe C. Par exemple, la box a pour adresse 192.168.1.1, le masque de réseau est 255.255.255.0 et tous les appareils connectés à la box ont une adresse de la forme 192.168.1.a. Donc un ordinateur peut être connecté avec l'adresse 192.168.1.10, un smartphone avec l'adresse 192.168.1.14 et une imprimante avec l'adresse 192.168.1.20 etc. Il s'agit d'un réseau privé. Si l'un des appareils se connecte à un réseau public comme Internet, il passe par la box, qui sert de passerelle. Celle-ci a une adresse IP assignée par le fournisseur d'accès et c'est cette seule adresse qui est visible depuis Internet, elle permet à tous les appareils connectés à la box d'y accéder en même temps.

Les classes sont de moins en moins utilisées. Actuellement les réseaux sont subdivisés en sous-réseaux et les notations utilisées permettent d'avoir un découpage plus fin. Par exemple la notation 192.168.1.18/27 indique l'adresse IP 192.168.1.18 et précise que les 27 premiers bits constituent l'adresse du sous-réseau, les 5 derniers l'adresse de l'hôte, laissant ainsi 2<sup>5</sup>=32 possibilités. Le masque s'écrit donc 11111111.11111111.11111111.11100000, soit 255.255.255.224 en notation décimale. Il y a deux adresses réservées : l'adresse du sous-réseau qui est 192.168.1.0, et l'adresse de broadcast qui est 192.168.1.31, c'est celle qui permet d'envoyer des informations à tous les postes du réseau. Il peut donc y avoir 30 machines hôtes d'adresses 192.168.1.1 à 192.168.1.30. L'adresse du sous réseau suivant est 192.168.1.32.

Avec le protocole IPv4, sur 4 octets soit 32 bits, c'est en théorie au maximum 2<sup>32</sup>=4 294 967 296 adresses qui peuvent être attribuées simultanément. En pratique, certaines ne sont pas disponibles mais dans tous les cas ce nombre n'est pas suffisant. En 2018, on compte plus de quatre milliard d'internautes dont plus de trois milliards connectés sur des réseaux sociaux. 

Les adresses IPv6 sont de plus en plus souvent utilisées. Elles utilisent 16 octets, soit 128 bits, ce qui permet 2<sup>128</sup> adresses possibles. Pour la notation les 16 octets sont regroupés en 8 groupes de 2 octets séparés par le signe deux-points. Par exemple : 2a00:1450:4007:80a::200e qui est une abréviation de 2a00:1450:4007:80a:0000:0000:0000:200e.


* Un **serveur DNS (Domain Name System)** permet d'associer une adresse IP à une adresse URL ; par exemple, avec un `ping` on trouvera que l'adresse IP associée au **serveur** du site www.education.gouv.fr est 152.199.21.182 ; c'est au serveur DNS qu'il revient donc de faire cette association. On peut savoir à qui est assignéee une adresse IP sur le site https://www.whois.com/whois/. Il suffit d'entrer l'adresse 216.58.213.174 et on constate que cette adresse appartient à l'organisation Google qui possède la plage d'adresse de 216.58.192.0 à 216.58.223.255.

* Une **adresse Ethernet ou adresse MAC (Media Access Control)** identifie de manière unique le matériel informatique comme étant connecté au réseau. Ce type d’adresse est attribué définitivement au périphérique lors de sa fabrication, par le constructeur lui-même. La différence avec une adresse IP est que cette dernière est attribuée de façon unique à un équipement connecté à un réseau spécifique. Mais, elle est attribuée par l’administrateur réseau (ou par le serveur DHCP). L'adresse Ethernet est constituée de 48bits (soient 6 octets) et est généralement représentée sous la forme hexadécimale (0 à 9 puis A à F), en séparant les octets par le caractère `:`. Ainsi 8H:A9:D5:67:E6:F3 serait une adresse Ethernet invalide à cause de la présence du H.  

* Les **protocoles** sont l'ensemble des **règles** qui régissent les échanges sur Internet. Ainsi dans le **protocole de communication IP (Internet Protocol)**, les données sont envoyées en plusieurs parties qui suivent des itinéraires différents au sein du réseau et qui arrivent à destination en respectant l'ordre de leur envoi.  
Le **protocole de bit alterné** est implémenté au niveau de la couche de "liaison de données" du modèle OSI (couche n°2), il ne concerne donc pas les paquets, mais les trames (on parle de paquets uniquement à partir de la couche "Réseau" (couche 3) du modèle OSI). Le principe de ce protocole est simple, considérons 2 ordinateurs en réseau : un ordinateur A qui sera l'émetteur des trames et un ordinateur B qui sera le destinataire des trames. Au moment d'émettre une trame, A va ajouter à cette trame un bit (1 ou 0) appelé drapeau (flag en anglais). B va envoyer un accusé de réception (acknowledge en anglais souvent noté ACK) à destination de A dès qu'il a reçu une trame en provenance de A. À cet accusé de réception on associe aussi un bit drapeau (1 ou 0). La règle est relativement simple : la première trame envoyée par A aura pour drapeau 0, dès que cette trame est reçue par B, ce dernier va envoyer un accusé de réception avec le drapeau 1 (ce 1 signifie "la prochaine trame que A va m'envoyer devra avoir son drapeau à 1"). Dès que A reçoit l'accusé de réception avec le drapeau à 1, il envoie la 2e trame avec un drapeau à 1, et ainsi de suite... Le système de drapeau est complété avec un système d'horloge côté émetteur. Un "chronomètre" est déclenché à chaque envoi de trame, si au bout d'un certain temps, l'émetteur n'a pas reçu un acquittement correct (avec le bon drapeau), la trame précédemment envoyée par l'émetteur est considérée comme perdue et est de nouveau envoyée. En conclusion, le protocole du bit alterné permet de détecter des pertes de données lors de la transmission de données sur un réseau.   
Le **protocole DHCP (Dynamic Host Configuration Protocol)** est un protocole réseau dont le rôle est d'assurer la configuration automatique des paramètres TCP/IP d'une station, notamment en lui assignant automatiquement, de façon **dynamique**, une adresse IP et un masque de sous-réseau.

* L'**encapsulation**, pour les réseaux informatiques, est un procédé consistant **à inclure les données d'un protocole dans un autre protocole**. Ainsi un fragment de donnée est encapsulé dans un datagramme UDP qui lui-même est encapsulé dans un paquet IP, ce dernier étant alors envoyé via un protocole de la couche de liaison (par exemple Ethernet). La couche de liaison est responsable de la transmission physique des données ; IP ajoute l'adressage des ordinateurs individuels ; UDP ajoute « l'adressage des applications » (c'est-à-dire le port spécifiant le service comme un service web ou un serveur TFTP). Le modèle OSI et la suite des protocoles Internet utilisent l'encapsulation.

-> Pour simuler un réseau, utilisez le logiciel gratuit **Filius**

1) Réalisez l'architecture d'un réseau en plaçant deux ordinateurs Notebook ou Portable ; en cliquant sur eux, donnez-leur des noms simples M1 et M2 et des adresses IP simples : 192.168.0.1 et  192.168.0.2 ; les relier par un câble Ethernet puis passer en mode simulation (triangle vert à côté du marteau). En cliquant sur une machine, on ouvre une fenêtre qui permet d'utiliser un logiciel sur un ordinateur ; on installe le logiciel Command Line ou Ligne de commande (appliquer les modifications) pour écrire des **lignes de commande** : on utilise la commande **ipconfig** pour vérifier l'adresse IP de la machine ; celle-ci est formée de 4 octets en notation décimale, ainsi que l'adresse MAC de la machine ; celle-ci est formée de 6 octets en notation hexadécimale, puis on envoie un **ping** sur la  machine M2 en renseignant son adresse IP. Observer que les échanges de packets sont visibles par le changement de couleur du câble réseau. 
<img src="assets/Filius1.png"> 
2) Revenons maintenant à la configuration du réseau (avec le marteau) et supprimons le câble (clic droit sur celui-ci) pour placer un troisième ordinateur M3 d'IP 192.168.0.3 ; connectons les trois ordinateurs à un switch avec trois câbles ; en mode simulation maintenant faire maintenant un ping depuis la machine M1 vers la machine M3 en repassant au mode simulation pour vérifier la transmission et la réception des paquets grâce à l'intermédiaire du Switch.  
<img src="assets/Filius2.png"> 
3) Réaliser maintenant deux réseaux comportant chacun trois machines (M1,M2,M3) et (M4,M5,M6) et deux Switch R1 et R2 ; on choisit l'adresse réseau de R1 : 192.168.1.0 et celle de R2 : 192.168.2.0 ; affecter en conséquence les IP des machines affectées à ces réseaux. Relier les deux réseaux en connectant les Switch grâce à un Routeur (sélectionner 2 interfaces). En cliquant sur le Routeur, renseigner son adresse IP 192.168.1.254 pour le réseau R1 et 192.168.2.254  pour le réseau R2. Sélectionner dans l'onglet Général l'option 'Routage automatique' pour que le routeur gère automatiquement les tables de routage ; puis pour chaque machine du réseau R1 et pour chaque machine du réseau R2, renseigner le Gateway ou Passerelle correspondant à l'adresse IP du routeur donnée plus haut. Testons l'architecture en faisant un ipconfig sur la machine M1 pour voir l'IP du routeur puis en réalisant un ping entre deux machines n'appartenant pas au même réseau; utiliser également la commande traceroute suivi de l'IP de la machine à atteindre pour suivre le chemin suivi par un paquet de données.
<img src="assets/Filius3.png"> 
4) Ajouter maintenant à cette configuration un ordinateur que l'on nommera "Serveur DNS" en le câblant au routeur après avoir ajouté ce dernier (signe +)  avec le bouton Gérer les connexions ; renseigner l'IP 192.168.3.1 et le Gateway ou Passerelle  192.168.3.254 ; puis en cliquant sur le Routeur après câblage ajouter l'adresse IP 192.168.3.254. Puis en cliquant sur la machine M1 changer Serveur DNS en lui donnant l'adresse IP 192.168.3.1. Passer en mode simulation, cliquer sur l'ordinateur Serveur DNS et installer le logiciel Serveur DNS ; ouvrir le logiciel, donner le nom de domaine M4 à l'adresse IP 192.168.2.1, ajouter puis démarrer. À partir de M1 maintenant, on peut écrire directement ' ping M4 ' car le serveur DNS a associé le nom M4 à l'adresse IP de cette machine.
<img src="assets/Filius4.png"> 
5) Ajouter maintenant un ordinateur que l'on nommera "Serveur Web" à cette configuration en le connectant au Routeur : déclarer l'adresse IP 192.168.4.1 ; la Passerelle 192.168.4.254 et le Serveur DNS 192.168.3.1 ; indiquer également l'IP 192.168.4.254 dans la configuration du routeur ; en mode simulation, cliquer sur la machine Serveur Web pour installer les logiciels File Explorer (Explorateur de fichiers), Text Editor (éditeur de texte) et Web Server  ; démarrer le Serveur Web (modifier la page d'accueil index.html avec l'éditeur de texte, fichier, ouvrir..pour la personnaliser, elle est située dans le dossier web serveur ) ; associer maintenant le nom de domaine my_web à l'adresse IP du Serveur Web avec le Serveur DNS ; à partir de la machine M1 , installer un Web browser (ou navigateur) et visualiser la page d'accueil fournie par le Serveur Web : http://my_web ou http://192.168.4.1/; vérifier que la page est également accessible depuis tout autre ordinateur du réseau 2 après avoir précisé pour celui-ci l'adresse du Serveur DNS.
<img src="assets/Filius5.png"> 
<img src="assets/Filius6.png"> 